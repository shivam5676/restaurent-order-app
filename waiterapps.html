<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <form onsubmit="savevalueincrud(event)">
        <label for="price">PRICE</label>
        <input type="tel" id="price" name="pricedata">
        <label for="dish">DISH</label>
        <input type="text" id="dish" name="dishdata">
        <label for="table">SELECT TABLE</label>
        <select id="table" name="tabledata">

            <option>table1</option>
            <option>table2</option>
            <option>table3</option>
        </select>


        <input type="submit" value="ADD ITEM">

    </form>
    <ul id="table1">TABLE 1</ul>
    <ul id="table2">TABLE 2</ul>
    <ul id="table3">TABLE 3</ul>
    <script>
        function savevalueincrud(event) {
            event.preventDefault();
            const price = event.target.pricedata.value;
            const dish = event.target.dishdata.value;
            const tables = event.target.tabledata.value;

            const myobj = {
                price,
                dish,
                tables
            }
            localStorage.setItem("userder", JSON.stringify(myobj))
            axios.post("https://crudcrud.com/api/e93eb99a4b7a42968ec7ae8dccf6da25/data", myobj)
                .then((reso) => {
                    console.log(reso)
                    showdata(myobj);
                })
                .catch((err) => {
                    console.log(err)
                })



        }
        window.addEventListener("DOMContentLoaded", () => {
            axios.get("https://crudcrud.com/api/e93eb99a4b7a42968ec7ae8dccf6da25/data")
                .then((res) => {
                    for (var i = 0; i < res.data.length; i++) {
                        showdata(res.data[i])
                    }
                })
        })
        function showdata(myobj) {
            const parent1 = document.getElementById("table1");
            const parent2 = document.getElementById("table2");
            const parent3 = document.getElementById("table3");
            const child = document.createElement("li")

            const deletebtn = document.createElement("input")
            deletebtn.type = "button"
            deletebtn.value = "delete order"

            const deletebtn2 = document.createElement("input")
            deletebtn2.type = "button"
            deletebtn2.value = "delete order"
            const deletebtn3 = document.createElement("input")
            deletebtn3.type = "button"
            deletebtn3.value = "delete order"



            child.textContent = myobj.price + "__" + myobj.dish + "____" + myobj.tables + "___" + myobj._id;




            if (myobj.tables == "table1") {
                deletebtn.onclick = () => {
                    axios.delete(`https://crudcrud.com/api/e93eb99a4b7a42968ec7ae8dccf6da25/data/${myobj._id}`)
                        .then((ress) => {
                            console.log(ress)
                            parent1.removeChild(child)
                        })
                        .catch((err) => {
                            console.log(err)
                        })



                }
                parent1.appendChild(child)
                child.append(deletebtn)
            }
            if (myobj.tables == "table2") {
                deletebtn2.onclick = () => {
                    axios.delete(`https://crudcrud.com/api/e93eb99a4b7a42968ec7ae8dccf6da25/data/${myobj._id}`)
                        .then((ress) => {
                            console.log(ress)
                            parent2.removeChild(child)
                        })
                        .catch((err) => {
                            console.log(err)
                        })
                    
                }

                parent2.appendChild(child)
                child.append(deletebtn2)
            }
            if (myobj.tables == "table3") {
                deletebtn3.onclick = () => {
                    axios.delete(`https://crudcrud.com/api/e93eb99a4b7a42968ec7ae8dccf6da25/data/${myobj._id}`)
                        .then((ress) => {
                            console.log(ress)
                            parent3.removeChild(child)
                        })
                        .catch((err) => {
                            console.log(err)
                        })


                    
                }

                console.log("true")
                parent3.appendChild(child)
                child.append(deletebtn3)
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>

</body>

</html>